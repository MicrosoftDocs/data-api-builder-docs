# Microsoft Learn build/review rulebook (agent)

This file consolidates the most common Microsoft Learn build/review validations relevant to this repo, with quick fixes.

The source material is the Microsoft Learn Platform Manual error reference pages (for example: `https://learn.microsoft.com/help/platform/validation-ref/<rule-code>`).

## Links

### `docs-link-absolute`

- Meaning: Absolute links to Learn pages break in isolated/offline build environments and aren’t checked by Learn Build.
- Fix: Use a relative link (same docset) or site-relative link (different docset).
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/docs-link-absolute`

### `hard-coded-locale`

- Meaning: Locale codes (for example, `/en-us/`) cause localized pages to link to English content.
- Fix: Remove locale codes for Microsoft sites in scope (including `learn.microsoft.com`).
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/hard-coded-locale`

### `preserve-view-not-set`

- Meaning: If you specify `?view=...` you must also set `&preserve-view=true`, otherwise Learn can’t distinguish author intent from autogenerated view.
- Fix (preferred): Remove `view` if not essential.
- Fix (if essential): Add `&preserve-view=true`.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/preserve-view-not-set`

## Images and alt text

### `alt-text-missing`

- Meaning: Images without alt text aren’t accessible.
- Fix: Provide meaningful alt text.
- Guideline: 10–250 characters (50–150 recommended).
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/alt-text-missing`

### `alt-text-bad-value`

- Meaning: Alt text can’t be the image name; it must describe purpose/content.
- Fix: Replace with meaningful alt text.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/alt-text-bad-value`

### `duplicate-alt-text`

- Meaning: Multiple images in one article share the same alt text (accessibility + SEO problem).
- Fix: Make each image’s alt text unique and meaningful.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/duplicate-alt-text`

### `image-name-incomplete`

- Meaning: New image filenames must use complete words and allowed abbreviations/acronyms, hyphen separated.
- Fix: Rename the image to use complete words separated by hyphens.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/image-name-incomplete`

### `image-name-exceeds-max-length`

- Meaning: Image names must be 80 characters or less.
- Fix: Shorten the image filename.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/image-name-exceeds-max-length`

## Filenames and folder names

### `filename-invalid-character` / `folder-name-invalid-character`

- Meaning: Names must be URL-safe.
- Fix: Use only lowercase letters, numbers, and hyphens.

### `filename-exceeds-max-length` / `folder-name-exceeds-max-length`

- Meaning: 80 character limit.
- Fix: Shorten names.

### `filename-incomplete` / `folder-name-incomplete`

- Meaning: New names must use complete words and allowed abbreviations/acronyms.
- Fix: Rename using complete words separated by hyphens.

### `filename-contains-stop-word` / `folder-name-contains-stop-word`

- Meaning: Some stop words aren’t allowed in new filenames/folder names.
- Fix: Remove the stop word(s) and use complete words separated by hyphens.

### Allow lists (related)

- The allow lists used by multiple naming rules are documented here:
  - `https://learn.microsoft.com/help/platform/validation-ref/allowed-gerunds-terms-acronyms-abbreviations`
- If a token must be used and is being flagged, request allowlisting via the form linked from that page.

## Markdown correctness

### `code-block-unclosed`

- Meaning: An unclosed fenced code block breaks rendering for the rest of the page.
- Fix: Close the code block with matching triple backticks.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/code-block-unclosed`

### `code-block-indented`

- Meaning: Indented code blocks aren’t allowed (no language can be specified; indentation can unintentionally render as code).
- Fix: Use fenced code blocks with a language label (for example, ` ```bash `).
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/code-block-indented`

## Headings

### `h1-missing` / `h1-empty` / `h1-not-first`

- Meaning: The article must have a non-empty H1 (`# ...`) and it must be the first content after the YAML header.
- Fix: Add/fix the H1, and move any content below it.

### `duplicate-h1s`

- Meaning: An article must not have multiple H1 headings.
- Fix: Keep one H1; demote others to H2/H3 as appropriate.

### `duplicate-h2s`

- Meaning: Duplicate headings are an accessibility violation.
- Fix: Rename headings so they’re unique within the article.

### `disallowed-heading`

- Meaning: Some headings are auto-generated by Learn (for example, feedback headings). Authoring them duplicates headings.
- Fix: Remove/rename the heading.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/disallowed-heading`

## Metadata

### `author-missing`

- Meaning: `author` identifies the GitHub owner.
- Fix: Add `author: <github-id>` in the YAML header.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/author-missing`

### `description-missing`

- Meaning: `description` is required for SEO and search.
- Fix: Add a meaningful 100–160 character description.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/description-missing`

### `duplicate-titles`

- Meaning: `title` must be unique (title + titleSuffix).
- Fix: Update titles or use `titleSuffix` as appropriate.

### `article-title-description`

- Meaning: Ensures new articles have complete and relevant `title`/`description` metadata.
- Fix: Make metadata complete and relevant.
- Reference: `https://learn.microsoft.com/help/platform/review-ref/article-title-description`

### `ai-usage-invalid`

- Meaning: If `ai-usage` is present, the value must be one of: `ai-assisted`, `ai-generated`, `human-only`.
- Fix: Correct the value or remove the attribute if not used.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/ai-usage-invalid`

## HTML safety

### `disallowed-html-tag` / `disallowed-html-attribute`

- Meaning: Non-allowlisted HTML is stripped in build and may be unsafe or inaccessible.
- Fix: Replace with standard Markdown or Learn supported syntax.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/disallowed-html-tag`

## External links

### `disallowed-domain`

- Meaning: Only allowlisted domains are permitted.
- Fix: Remove the link or request allowlisting.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/disallowed-domain`

## Dates

### `date-format-invalid`

- Meaning: Some metadata date fields must be in the expected format.
- Fix: Use the required date format for the field being validated.
- Reference: `https://learn.microsoft.com/help/platform/validation-ref/date-format-invalid`
